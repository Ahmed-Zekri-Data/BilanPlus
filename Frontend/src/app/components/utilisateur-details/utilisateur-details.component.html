<div class="user-detail-container">
  <div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h2>Détails de l'utilisateur</h2>
      <div>
        <button class="btn btn-primary me-2" (click)="editUser()">
          <i class="bi bi-pencil"></i> Modifier
        </button>
        <button class="btn btn-secondary" (click)="goBack()">
          <i class="bi bi-arrow-left"></i> Retour
        </button>
      </div>
    </div>
    
    <div class="card-body">
      <div *ngIf="loading" class="text-center mb-4">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Chargement...</span>
        </div>
      </div>
      
      <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
      
      <div *ngIf="utilisateur" class="user-profile">
        <div class="row">
          <div class="col-md-3 text-center mb-3">
            <div class="profile-image-container">
              <img 
                [src]="utilisateur.photo || 'assets/images/default-avatar.png'" 
                alt="Photo de profil" 
                class="profile-image img-fluid rounded-circle"
              >
            </div>
            <div class="mt-2">
              <span class="badge" [ngClass]="utilisateur.actif ? 'bg-success' : 'bg-danger'">
                {{ utilisateur.actif ? 'Actif' : 'Inactif' }}
              </span>
            </div>
          </div>
          
          <div class="col-md-9">
            <h3>{{ utilisateur.prenom }} {{ utilisateur.nom }}</h3>
            
            <div class="user-info">
              <div class="info-group">
                <span class="info-label">Email:</span>
                <span class="info-value">{{ utilisateur.email }}</span>
              </div>
              
              <div class="info-group">
                <span class="info-label">Rôle:</span>
                <span class="info-value">{{ utilisateur.role['nom'] || 'N/A' }}</span>
              </div>
              
              <div class="info-group">
                <span class="info-label">Téléphone:</span>
                <span class="info-value">{{ utilisateur.telephone || 'Non renseigné' }}</span>
              </div>
              
              <div class="info-group">
                <span class="info-label">Adresse:</span>
                <span class="info-value">{{ utilisateur.adresse || 'Non renseignée' }}</span>
              </div>
              
              <div class="info-group">
                <span class="info-label">Date de création:</span>
                <span class="info-value">{{ utilisateur.dateCreation | date:'dd/MM/yyyy HH:mm' }}</span>
              </div>
              
              <div class="info-group">
                <span class="info-label">Dernière connexion:</span>
                <span class="info-value">{{ utilisateur.dernierConnexion | date:'dd/MM/yyyy HH:mm' || 'Jamais' }}</span>
              </div>
            </div>
          </div>
        </div>
        
        <div class="mt-4">
          <h4>Préférences</h4>
          <div class="row">
            <div class="col-md-4">
              <div class="info-group">
                <span class="info-label">Thème:</span>
                <span class="info-value">{{ utilisateur.preferences.theme === 'light' ? 'Clair' : 'Sombre' }}</span>
              </div>
            </div>
            
            <div class="col-md-4">
              <div class="info-group">
                <span class="info-label">Langue:</span>
                <span class="info-value">{{ utilisateur.preferences.langue === 'fr' ? 'Français' : 'Anglais' }}</span>
              </div>
            </div>
            
            <div class="col-md-4">
              <div class="info-group">
                <span class="info-label">Notifications email:</span>
                <span class="info-value">{{ utilisateur.preferences.notificationsEmail ? 'Activées' : 'Désactivées' }}</span>
              </div>
            </div>
          </div>
        </div>
        
        <div *ngIf="utilisateur.role['permissions']" class="mt-4">
          <h4>Permissions</h4>
          <div class="permissions-container">
            <div class="row">
              <div *ngFor="let perm of getPermissionsArray()" class="col-md-4 mb-2">
                <div class="permission-item">
                  <i [class]="utilisateur.role['permissions'][perm] ? 'bi bi-check-circle-fill text-success' : 'bi bi-x-circle-fill text-danger'"></i>
                  {{ getPermissionLabel(perm) }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>